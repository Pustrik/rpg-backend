{"version":3,"file":"errorhandler.js","sourceRoot":"","sources":["../../../../src/middleware/socket-middleware/errorhandler.ts"],"names":[],"mappings":";;;;;AAAA,mFAA4E;AAC5E,qFAAuD;AAEvD,MAAM,YAAY,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;IACrC,MAAM,WAAW,GAAG,CAAC,GAAG,EAAE,EAAE;QACxB,OAAO,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,EAAG;YACxB,OAAO,EAAE,sBAAsB;YAC/B,IAAI,EAAE;gBACF,UAAU,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI;gBAChC,SAAS,EAAE,SAAS;gBACpB,SAAS,EAAE,SAAS;aACvB;YACD,GAAG;SACN,CAAC,CAAC;QACH,IAAG,CAAC,CAAC,GAAG,YAAY,wBAAQ,CAAC,EAAE;YAC3B,OAAO,wBAAa,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;SACvD;QACD,wBAAa,CAAC,WAAW,CAAC,GAAG,CAAC,OAAyB,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;IACvE,CAAC,CAAC;IAEF,OAAO,CAAC,GAAG,IAAI,EAAE,EAAE;QACf,IAAI;YACA,MAAM,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YACtC,IAAI,GAAG,IAAI,OAAO,GAAG,CAAC,KAAK,KAAK,UAAU,EAAE;gBACxC,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;aAC1B;SACJ;QAAC,OAAO,CAAC,EAAE;YACR,WAAW,CAAC,CAAC,CAAC,CAAC;SAClB;IACL,CAAC,CAAC;AACN,CAAC,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import SocketService, {SocketResponse} from \"../../services/socket-service\";\nimport ApiError from \"../../exteptions/api-exceptions\";\n\nconst errorHandler = (handler, socket) => {\n    const handleError = (err) => {\n        console.error('error', '',  {\n            message: 'Error Handler Socket',\n            body: {\n                inFunction: Object(handler).name,\n                secretKey: undefined,\n                publicKey: undefined\n            },\n            err\n        });\n        if(!(err instanceof ApiError)) {\n            return SocketService.sendMessage('error', [socket]);\n        }\n        SocketService.sendMessage(err.message as SocketResponse, [socket]);\n    };\n\n    return (...args) => {\n        try {\n            const ret = handler.apply(this, args);\n            if (ret && typeof ret.catch === \"function\") {\n                ret.catch(handleError);\n            }\n        } catch (e) {\n            handleError(e);\n        }\n    };\n};\n\nexport default errorHandler;"]}