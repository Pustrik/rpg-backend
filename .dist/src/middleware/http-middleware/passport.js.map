{"version":3,"file":"passport.js","sourceRoot":"","sources":["../../../../src/middleware/http-middleware/passport.ts"],"names":[],"mappings":";;;;;AAAA,qFAAuD;AACvD,iFAAwD;AAExD,MAAM,QAAQ,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;IAChC,IAAI;QACA,MAAM,UAAU,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QAC7C,IAAG,CAAC,UAAU;YACV,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,YAAY,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9C,IAAG,CAAC,YAAY;YACZ,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,QAAQ,GAAG,uBAAY,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;QAC3D,IAAG,CAAC,QAAQ;YACR,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,GAAG,CAAC,IAAI,GAAG,QAAQ,CAAC;QACpB,IAAI,EAAE,CAAC;KACV;IAAC,OAAO,CAAC,EAAE;QACR,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;KAC7C;AACL,CAAC,CAAA;AACD,kBAAe,QAAQ,CAAC","sourcesContent":["import ApiError from \"../../exteptions/api-exceptions\";\nimport TokenService from \"../../services/token-service\";\n\nconst passport = (req, res, next) => {\n    try {\n        const authHeader = req.headers.authorization;\n        if(!authHeader)\n            return next(ApiError.unauthorizedError());\n\n        const access_token = authHeader.split(' ')[1];\n        if(!access_token)\n            return next(ApiError.unauthorizedError());\n\n        const userData = TokenService.validateAccess(access_token);\n        if(!userData)\n            return next(ApiError.unauthorizedError());\n\n        req.user = userData;\n        next();\n    } catch (e) {\n        return next(ApiError.unauthorizedError());\n    }\n}\nexport default passport;"]}